@page "/login"
@{

}
<!--banner ends-->
<div class="recipes-home-body inner-page">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-lg-9">
                <div class="recipe-set submit-recipe-set">
                    <h2>Đăng nhập</h2>
                    <div class="submit-recipe-form">
                        <form action="#" method="post" id="login-form">
                            <label for="title">Tên đăng nhập</label>
                            <input type="text" name="username" />
                            <label for="title">Mật khẩu*</label>
                            <input type="text" name="password" />
                            <div class="text-center">
                                <button type="submit" class="recipe-submit-btn">Đăng nhập</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-lg-3">
                <aside>
                    <div class="side-bar">
                        <!--recipes search widget-->
                        <div class="widget recipe-search">
                            <div class="search-bar-widget">
                                <form action="#">
                                    <div class="search-field">
                                        <input type="search" name="search" placeholder="Search" />
                                        <button type="submit"><i class="fa fa-search"></i></button>
                                    </div>
                                </form>
                            </div>

                            <div class="category-list">
                                <!--<div class="list-inner">-->
                                <ul id="list-category-item-loginpage"></ul>
                                <!--</div>-->
                            </div>
                        </div>
                        <!--recipes search widget ends-->
                        <!--popular recipes widget-->
                        <div class="widget latest-news-widget">
                            <h2>popular recipes</h2>
                            <ul id="list-popular-recipe-widget-loginpage"></ul>
                        </div>
                        <!--popular recipes widget ends-->
                        <div class="widget">
                            <a href="#">
                                <img src="recipepress/images/temp-images/add-side.jpg" alt="Add" />
                            </a>
                        </div>
                        <!--latest news widget-->
                        <div class="widget latest-news-widget">
                            <h2>Latest News</h2>
                            <ul id="list-latest-recipe-widget-loginpage"></ul>
                        </div>
                        <!--latest news widget ends-->
                        <!--get social-->
                        <div class="widget widget-get-social">
                            <h2>get social</h2>
                            <ul>
                                <li class="facebook">
                                    <a href="#">
                                        <i class="fa fa-facebook"></i>
                                        <span class="count">23.5K</span>
                                        <span class="count-type">Likes</span>
                                    </a>
                                </li>
                                <li class="twitter">
                                    <a href="#">
                                        <i class="fa fa-twitter"></i>
                                        <span class="count">23.5K</span>
                                        <span class="count-type">Likes</span>
                                    </a>
                                </li>
                                <li class="google-plus">
                                    <a href="#">
                                        <i class="fa fa-google-plus"></i>
                                        <span class="count">23.5K</span>
                                        <span class="count-type">Likes</span>
                                    </a>
                                </li>

                            </ul>
                        </div>
                        <!--get social ends-->
                    </div>
                </aside>
            </div>
        </div>

    </div>
</div>

<script src="~/js/login.js"></script>
@section Scripts
    {
    <script>

        $("#login-form").on("submit", async function (e) {
            e.preventDefault();
            var formData = $('#login-form').serialize();
            $.ajax({
                url: "https://localhost:44361/api/account/login?" + formData,
                method: "POST",
                success: function (data) {
                    // Get Object Token and add username into
                    var username = $("input[name='username']").val();
                    // store to local storage
                    window.localStorage.setItem("authorization", JSON.stringify(data));
                    window.localStorage.setItem("username", username);
                    window.location.href = "/";
                },
                error: function (error) {
                    console.log("Login Submit Error: ", error)
                }
            })
        });

    </script>
    <script type="text/javascript">
        // fetch and render element to html
        (async () => {
            await callLatestRecipeWidgetLoginPageApi();
            await callListCategoryItemLoginPageApi();
            await callPopularLoginPageApi();
        })();
    </script>

}